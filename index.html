<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ðŸ’¥ zettelkasten.shop ðŸ’¥</title>
  <link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
  <link rel="manifest" href="images/favicon/site.webmanifest">
  <link rel="icon" type="image/png" sizes="192x192" href="images/favicon/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="images/favicon/android-chrome-512x512.png">
  <meta name="theme-color" content="#402554">
  <link href="https://fonts.googleapis.com/css2?family=PT+Mono&family=PT+Sans+Pro&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    :root {
      --primary-bg: #402554;
      --header-color: #E6B7FF;
      --paragraph-color: #ffffff;
      --border-color: #C51BFE;
    }
    body {
      font-family: 'PT Sans Pro', sans-serif;
      margin: 0;
      background-color: var(--primary-bg);
      color: var(--paragraph-color);
      font-size: 16px;
      line-height: 1.6;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      /* position: relative; -- can stay or go, but not needed for #menu anymore */
    }
    /* Changed position to sticky, removed position: relative; added top: 0; */
    #menu {
      position: sticky;
      top: 0;
      z-index: 9999; /* ensures the menu appears on top */
      background: var(--primary-bg);
      padding: 10px 20px;
      font-family: 'PT Mono', monospace;
    }
    #menu-toggle {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--border-color);
      cursor: pointer;
      display: block;
      margin: 0 auto;
    }
    #dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      height: 90vh;
      width: 100%;
      background: var(--primary-bg);
      border: 2px solid var(--border-color);
      box-sizing: border-box;
      padding: 10px;
      transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
      max-height: 0;
      overflow-y: auto;
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    #dropdown-menu::-webkit-scrollbar {
      width: 0;
      display: none;
    }
    #dropdown-menu.show {
      max-height: 700px;
      opacity: 1;
      pointer-events: auto;
    }
    #dropdown-menu a {
      text-decoration: none;
      color: var(--paragraph-color);
      font-weight: bold;
      margin-right: 10px;
    }
    #dropdown-menu input {
      width: 100%;
      padding: 8px;
      border: 2px solid var(--border-color);
      margin-top: 10px;
      background: transparent;
      color: var(--paragraph-color);
    }
    #posts-container {
      margin-top: 10px;
      overflow-y: auto;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    #posts-container::-webkit-scrollbar {
      width: 0;
      display: none;
    }
    .content {
      padding: 20px;
    }
    .content h1,
    .content h2,
    .content h3 {
      font-family: 'PT Mono', monospace;
      color: var(--header-color);
      margin-top: 1em;
      margin-bottom: 0.5em;
      line-height: 1.3;
    }
    .content p,
    .content ul,
    .content ol,
    .content li {
      font-family: 'PT Sans Pro', sans-serif;
      margin-bottom: 1.5em;
      max-width: 65ch;
      margin-left: auto;
      margin-right: auto;
    }
    .content img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1em auto;
    }
    .content h1::after {
      content: "";
      display: block;
      width: 100%;
      height: 4px;
      background-color: var(--border-color);
      margin-top: 10px;
    }
    .card {
      background: transparent;
      border: 2px solid var(--border-color);
      margin-bottom: 15px;
      padding: 10px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .card:hover {
      background-color: rgba(197, 27, 254, 0.1);
    }
    .card .title {
      font-size: 1.2em;
      font-weight: bold;
      font-family: 'PT Mono', monospace;
      color: var(--header-color);
    }
    .card .date {
      font-size: 0.9em;
      font-family: 'PT Mono', monospace;
      color: var(--paragraph-color);
    }
    @media (max-width: 600px) {
      .container {
        max-width: 90%;
      }
      #dropdown-menu {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <nav id="menu">
      <button id="menu-toggle"><i data-feather="menu"></i></button>
      <div id="dropdown-menu">
        <a href="#" id="home-menu">Main page</a>
        <a>|</a>
        <a href="#" id="about-menu">About this blog</a>
        <input type="text" id="search-box" placeholder="Search microblogs...">
        <div id="posts-container"></div>
      </div>
    </nav>
    <div class="content" id="content">
      <div class="post-wrapper" id="post-wrapper">
        <h1>blog.zettelkasten.shop</h1>
        <p>
          Welcome to this my experimental blog. To navigate, click the purple menu button in the center of the header; inside, youâ€™ll find links to the main page, the about page, and a searchable list of microblogs. Type any keywords into the search bar to filter through older posts. Iâ€™m exploring different blogging formats here, so things may look or feel different as this evolves. My goal is that each short post provides a fresh insight or valuable thought. Enjoy browsing, and thanks for stopping by!
        </p>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    function formatDate(e){return new Date(e.replace(/-/g,"/")).toLocaleDateString(undefined,{year:"numeric",month:"short",day:"numeric"})}
    function embedYouTubeVideos(h){const d=document.createElement("div");d.innerHTML=h;const r=/^(https?:\/\/(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/))([A-Za-z0-9_-]{11})(?:\S*)$/;d.querySelectorAll("p").forEach(p=>{const t=p.textContent.trim(),m=t.match(r);if(m){const i=m[2],f='<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: black;"><iframe src="https://www.youtube.com/embed/'+i+'" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>';p.outerHTML=f}});return d.innerHTML}
    async function loadMarkdown(u){try{const r=await fetch(u);if(!r.ok)throw new Error("Network response was not ok");const t=await r.text();history.pushState(null,"","?post="+encodeURIComponent(u));const c=document.getElementById("content");let e=marked.parse(t);e=embedYouTubeVideos(e);c.innerHTML='<div class="post-wrapper">'+e+"</div>"}catch(o){document.getElementById("content").innerHTML='<div class="post-wrapper"><p>Error loading microblog.</p></div>'}}
    async function loadMarkdownExternal(u){try{const r=await fetch(u);if(!r.ok)throw new Error("Network response was not ok");const t=await r.text();let e=marked.parse(t);e=embedYouTubeVideos(e);document.getElementById("content").innerHTML='<div class="post-wrapper">'+e+"</div>"}catch(o){document.getElementById("content").innerHTML='<div class="post-wrapper"><p>Error loading content.</p></div>'}}
    function renderPosts(a){const c=document.getElementById("posts-container");c.innerHTML="";a.forEach(p=>{const d=document.createElement("div");d.className="card";const t=document.createElement("div");t.className="title";t.textContent=p.title;const s=document.createElement("div");s.className="date";s.textContent=formatDate(p.date_published);d.appendChild(t);d.appendChild(s);d.addEventListener("click",()=>{loadMarkdown(p.link)});c.appendChild(d)})}
    let validPostsGlobal=[];
    const defaultContent='<div class="post-wrapper"><h1>blog.zettelkasten.shop</h1><p>Welcome to this experimental blog. To navigate, click the purple menu button in the center of the header; inside, youâ€™ll find links to the main page, the about page, and a searchable list of microblogs. Type any keywords into the search bar to filter through older posts. Iâ€™m exploring different blogging formats here, so things may look or feel different as this evolves. My goal is that each short post provides a fresh insight or valuable thought. Enjoy browsing, and thanks for stopping by!</p></div>';
    async function loadPosts(){try{const r=await fetch("posts.json");if(!r.ok)throw new Error("Failed to fetch posts.json");const t=await r.json();const e=await Promise.all(t.map(async o=>{try{const n=await fetch(o.link,{method:"HEAD"});if(!n.ok)throw new Error("Status "+n.status);return o}catch(i){return null}}));const a=e.filter(o=>o!==null);a.sort((o,n)=>new Date(n.date_published)-new Date(o.date_published));validPostsGlobal=a;renderPosts(validPostsGlobal);const c=new URLSearchParams(window.location.search),d=c.get("post");if(d){const s=validPostsGlobal.find(o=>o.link===d);if(s)loadMarkdown(s.link)}}catch(p){document.getElementById("posts-container").innerHTML="<p>Error loading microblogs.</p>"}}
    document.addEventListener("DOMContentLoaded", function() {
      loadPosts();
      feather.replace();
    });
    document.getElementById("search-box").addEventListener("input",function(e){const t=e.target.value.toLowerCase();const a=validPostsGlobal.filter(p=>p.title.toLowerCase().includes(t));renderPosts(a)});
    document.getElementById("home-menu").addEventListener("click",e=>{
      e.preventDefault();
      document.getElementById("content").innerHTML=defaultContent;
      history.pushState(null,"",window.location.pathname)
    });
    document.getElementById("about-menu").addEventListener("click", e => {
      e.preventDefault();
      const t = "README.md";
      loadMarkdownExternal(t);
    });
    document.getElementById("menu-toggle").addEventListener("click",function(){
      document.getElementById("dropdown-menu").classList.toggle("show")
    });
    document.addEventListener("click",function(e){
      const m=document.getElementById("dropdown-menu"),
            t=document.getElementById("menu-toggle");
      if(!m.contains(e.target)&&!t.contains(e.target)){
        m.classList.remove("show")
      }
    });
  </script>
</body>
</html>
